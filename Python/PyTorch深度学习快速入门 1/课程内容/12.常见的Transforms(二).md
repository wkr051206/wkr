## Resize
![](media/Pasted%20image%2020250815205010.png)
这是一个标准的PyTorch transforms类，用于深度学习中图像数据的预处理。特点：

1. 
​​智能尺寸适应​​：
输入整数（如256）：保持比例缩放，使短边匹配该值
输入元组（如(224,224)）：强制指定宽高
2. 
​​自动比例计算​​：
![](media/Pasted%20image%2020250815205352.png)
3. 
​​插值算法可配置​​：
默认双线性插值（最平衡的质量/速度）
支持其他PIL插值方法（如NEAREST, BICUBIC等）

## PyTorch RandomCrop()用法详解

RandomCrop()是 PyTorch torchvision.transforms模块中用于数据增强的核心工具，它会在图像上​​随机裁剪指定大小的区域​​。这个操作在训练深度学习模型时至关重要，能有效防止过拟合并提升模型泛化能力。
### 核心功能解析
```python
from torchvision import transforms

# 基本用法
transform = transforms.RandomCrop(size)
cropped_img = transform(original_img)
```

### 关键特性
1. ​​随机位置裁剪​​：每次调用都会随机选择裁剪位置
2. 尺寸灵活性​​：
    •size可以是整数（正方形裁剪）
    •或元组 (height, width)（矩形裁剪）
3. 填充选项​​：当图像小于裁剪尺寸时自动填充
4. 数据增强​​：通过随机裁剪增加数据多样性

### 参数详解
![](media/Pasted%20image%2020250815212918.png)

### 示例1：基本正方形裁剪
```python
import torchvision.transforms as T
from PIL import Image

# 加载图像
img = Image.open("cat.jpg")

# 创建裁剪器（224x224随机裁剪）
crop = T.RandomCrop(224)

# 应用裁剪（每次位置随机）
cropped_img1 = crop(img)  # 第一次裁剪
cropped_img2 = crop(img)  # 第二次裁剪（不同位置）
```

### 示例2：矩形裁剪加填充
```python
# 创建300x200矩形裁剪器，带灰色填充
crop = T.RandomCrop(
    size=(300, 200),
    padding=20,  # 四周填充20像素
    pad_if_needed=True,  # 图像小于300x200时自动填充
    padding_mode='constant',
    fill=(128, 128, 128)  # 灰色填充
)
```

### 示例3：组合变换（推荐）
```python
# 完整的数据增强流程
transform = T.Compose([
    T.Resize(256),  # 先缩放到256px
    T.RandomCrop(224),  # 随机裁剪224x224
    T.RandomHorizontalFlip(p=0.5),  # 50%概率水平翻转
    T.ToTensor()  # 转为PyTorch张量
])

# 应用于训练数据集
train_dataset = datasets.ImageFolder(
    'data/train',
    transform=transform
)
```

![](media/Pasted%20image%2020250815213621.png)